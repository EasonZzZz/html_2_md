<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>网络层 | Nice To Meet U</title><meta name="description" content="网络层"><meta name="keywords" content="计网"><meta name="author" content="EasonZzZz"><meta name="copyright" content="EasonZzZz"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="网络层"><meta name="twitter:description" content="网络层"><meta name="twitter:image" content="https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture"><meta property="og:type" content="article"><meta property="og:title" content="网络层"><meta property="og:url" content="http://yoursite.com/2020/07/01/学习/计网/网络层/"><meta property="og:site_name" content="Nice To Meet U"><meta property="og:description" content="网络层"><meta property="og:image" content="https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.css"><link rel="canonical" href="http://yoursite.com/2020/07/01/学习/计网/网络层/"><link rel="prev" title="物理层" href="http://yoursite.com/2020/07/01/学习/计网/物理层/"><link rel="next" title="概述" href="http://yoursite.com/2020/07/01/学习/计网/概述/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://easonzzzz.github.io/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'true',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false,
  ClickShowText: undefined,
  medium_zoom: 'false',
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"按","message_next":"键将本页加入书签"},"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-left"}
  
}</script></head><body><div id="header"> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Nice To Meet U</a></span><i class="fa fa-bars fa-fw toggle-menu pull_right close" aria-hidden="true"></i><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 目录</span></a></div></div></span><span class="pull_right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lazyload avatar_img" src="https://raw.githubusercontent.com/EasonZzZz/BlogPic/master/img/20191025120143.png" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">106</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">41</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">10</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 目录</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#传输单元"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> 传输单元</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#交换方式"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> 交换方式</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#电路交换"><span class="toc_mobile_items-number">2.1.</span> <span class="toc_mobile_items-text"> 电路交换</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#报文交换"><span class="toc_mobile_items-number">2.2.</span> <span class="toc_mobile_items-text"> 报文交换</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#分组交换"><span class="toc_mobile_items-number">2.3.</span> <span class="toc_mobile_items-text"> 分组交换</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#数据报和虚电路"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text"> 数据报和虚电路</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#数据报"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text"> 数据报</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#虚电路"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text"> 虚电路</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#对比"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text"> 对比</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#路由"><span class="toc_mobile_items-number">4.</span> <span class="toc_mobile_items-text"> 路由</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#路由算法"><span class="toc_mobile_items-number">4.1.</span> <span class="toc_mobile_items-text"> 路由算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#分类"><span class="toc_mobile_items-number">4.1.1.</span> <span class="toc_mobile_items-text"> 分类</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#分层次的路由选择协议"><span class="toc_mobile_items-number">4.2.</span> <span class="toc_mobile_items-text"> 分层次的路由选择协议</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#rip-协议和距离向量算法"><span class="toc_mobile_items-number">4.3.</span> <span class="toc_mobile_items-text"> RIP 协议和距离向量算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#rip特点"><span class="toc_mobile_items-number">4.3.1.</span> <span class="toc_mobile_items-text"> RIP特点</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#路由表的建立"><span class="toc_mobile_items-number">4.3.2.</span> <span class="toc_mobile_items-text"> 路由表的建立</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#rip报文"><span class="toc_mobile_items-number">4.3.3.</span> <span class="toc_mobile_items-text"> RIP报文</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#距离向量算法"><span class="toc_mobile_items-number">4.3.4.</span> <span class="toc_mobile_items-text"> 距离向量算法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ospf-协议与链路状态算法"><span class="toc_mobile_items-number">4.4.</span> <span class="toc_mobile_items-text"> OSPF 协议与链路状态算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#特点"><span class="toc_mobile_items-number">4.4.1.</span> <span class="toc_mobile_items-text"> 特点</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ospf报文"><span class="toc_mobile_items-number">4.4.2.</span> <span class="toc_mobile_items-text"> OSPF报文</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#链路状态路由算法"><span class="toc_mobile_items-number">4.4.3.</span> <span class="toc_mobile_items-text"> 链路状态路由算法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ospf的区域"><span class="toc_mobile_items-number">4.4.4.</span> <span class="toc_mobile_items-text"> OSPF的区域</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#bgp协议"><span class="toc_mobile_items-number">4.5.</span> <span class="toc_mobile_items-text"> BGP协议</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#交换过程"><span class="toc_mobile_items-number">4.5.1.</span> <span class="toc_mobile_items-text"> 交换过程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#特点-2"><span class="toc_mobile_items-number">4.5.2.</span> <span class="toc_mobile_items-text"> 特点</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#bgp-4四种报文"><span class="toc_mobile_items-number">4.5.3.</span> <span class="toc_mobile_items-text"> BGP-4四种报文</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#rip-ospf-和-bgp"><span class="toc_mobile_items-number">4.6.</span> <span class="toc_mobile_items-text"> RIP、OSPF 和 BGP</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ip数据报"><span class="toc_mobile_items-number">5.</span> <span class="toc_mobile_items-text"> IP数据报</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#格式"><span class="toc_mobile_items-number">5.1.</span> <span class="toc_mobile_items-text"> 格式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#分片"><span class="toc_mobile_items-number">5.2.</span> <span class="toc_mobile_items-text"> 分片</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ipv4-地址"><span class="toc_mobile_items-number">6.</span> <span class="toc_mobile_items-text"> IPv4 地址</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#分类的-ip-地址"><span class="toc_mobile_items-number">6.1.</span> <span class="toc_mobile_items-text"> 分类的 IP 地址</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#网络地址转换-nat"><span class="toc_mobile_items-number">6.1.1.</span> <span class="toc_mobile_items-text"> 网络地址转换 NAT</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#子网划分"><span class="toc_mobile_items-number">6.2.</span> <span class="toc_mobile_items-text"> 子网划分</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#子网掩码"><span class="toc_mobile_items-number">6.2.1.</span> <span class="toc_mobile_items-text"> 子网掩码</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#变长子网"><span class="toc_mobile_items-number">6.2.2.</span> <span class="toc_mobile_items-text"> 变长子网</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#无分类编址-cidr"><span class="toc_mobile_items-number">6.3.</span> <span class="toc_mobile_items-text"> 无分类编址 CIDR</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#记法"><span class="toc_mobile_items-number">6.3.1.</span> <span class="toc_mobile_items-text"> 记法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#路由聚合"><span class="toc_mobile_items-number">6.3.2.</span> <span class="toc_mobile_items-text"> 路由聚合</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#最长前缀匹配"><span class="toc_mobile_items-number">6.3.3.</span> <span class="toc_mobile_items-text"> 最长前缀匹配</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ipv4-路由转发"><span class="toc_mobile_items-number">6.4.</span> <span class="toc_mobile_items-text"> IPv4 路由转发</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#arp-协议"><span class="toc_mobile_items-number">7.</span> <span class="toc_mobile_items-text"> ARP 协议</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#dhcp-协议"><span class="toc_mobile_items-number">8.</span> <span class="toc_mobile_items-text"> DHCP 协议</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#icmp-协议"><span class="toc_mobile_items-number">9.</span> <span class="toc_mobile_items-text"> ICMP 协议</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#icmp-差错报文"><span class="toc_mobile_items-number">9.1.</span> <span class="toc_mobile_items-text"> ICMP 差错报文</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#icmp-询问报文"><span class="toc_mobile_items-number">9.2.</span> <span class="toc_mobile_items-text"> ICMP 询问报文</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#icmp-应用"><span class="toc_mobile_items-number">9.3.</span> <span class="toc_mobile_items-text"> ICMP 应用</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ipv6"><span class="toc_mobile_items-number">10.</span> <span class="toc_mobile_items-text"> IPv6</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ipv6-数据报格式"><span class="toc_mobile_items-number">10.1.</span> <span class="toc_mobile_items-text"> IPv6 数据报格式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ipv6-vs-ipv4"><span class="toc_mobile_items-number">10.2.</span> <span class="toc_mobile_items-text"> IPv6 vs IPv4</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#表示形式"><span class="toc_mobile_items-number">10.3.</span> <span class="toc_mobile_items-text"> 表示形式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#基本地址类型"><span class="toc_mobile_items-number">10.4.</span> <span class="toc_mobile_items-text"> 基本地址类型</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#过度策略"><span class="toc_mobile_items-number">10.5.</span> <span class="toc_mobile_items-text"> 过度策略</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#ip-组播"><span class="toc_mobile_items-number">11.</span> <span class="toc_mobile_items-text"> IP 组播</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#ip-组播地址"><span class="toc_mobile_items-number">11.1.</span> <span class="toc_mobile_items-text"> IP 组播地址</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#igmp-协议"><span class="toc_mobile_items-number">11.2.</span> <span class="toc_mobile_items-text"> IGMP 协议</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#组播路由选择协议"><span class="toc_mobile_items-number">11.3.</span> <span class="toc_mobile_items-text"> 组播路由选择协议</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#移动-ip"><span class="toc_mobile_items-number">12.</span> <span class="toc_mobile_items-text"> 移动 IP</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#路由器"><span class="toc_mobile_items-number">13.</span> <span class="toc_mobile_items-text"> 路由器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#拥塞控制"><span class="toc_mobile_items-number">14.</span> <span class="toc_mobile_items-text"> 拥塞控制</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#传输单元"><span class="toc-number">1.</span> <span class="toc-text"> 传输单元</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#交换方式"><span class="toc-number">2.</span> <span class="toc-text"> 交换方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#电路交换"><span class="toc-number">2.1.</span> <span class="toc-text"> 电路交换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#报文交换"><span class="toc-number">2.2.</span> <span class="toc-text"> 报文交换</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分组交换"><span class="toc-number">2.3.</span> <span class="toc-text"> 分组交换</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#数据报和虚电路"><span class="toc-number">3.</span> <span class="toc-text"> 数据报和虚电路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#数据报"><span class="toc-number">3.1.</span> <span class="toc-text"> 数据报</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#虚电路"><span class="toc-number">3.2.</span> <span class="toc-text"> 虚电路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#对比"><span class="toc-number">3.3.</span> <span class="toc-text"> 对比</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#路由"><span class="toc-number">4.</span> <span class="toc-text"> 路由</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#路由算法"><span class="toc-number">4.1.</span> <span class="toc-text"> 路由算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#分类"><span class="toc-number">4.1.1.</span> <span class="toc-text"> 分类</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分层次的路由选择协议"><span class="toc-number">4.2.</span> <span class="toc-text"> 分层次的路由选择协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rip-协议和距离向量算法"><span class="toc-number">4.3.</span> <span class="toc-text"> RIP 协议和距离向量算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rip特点"><span class="toc-number">4.3.1.</span> <span class="toc-text"> RIP特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#路由表的建立"><span class="toc-number">4.3.2.</span> <span class="toc-text"> 路由表的建立</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rip报文"><span class="toc-number">4.3.3.</span> <span class="toc-text"> RIP报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#距离向量算法"><span class="toc-number">4.3.4.</span> <span class="toc-text"> 距离向量算法</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ospf-协议与链路状态算法"><span class="toc-number">4.4.</span> <span class="toc-text"> OSPF 协议与链路状态算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#特点"><span class="toc-number">4.4.1.</span> <span class="toc-text"> 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ospf报文"><span class="toc-number">4.4.2.</span> <span class="toc-text"> OSPF报文</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#链路状态路由算法"><span class="toc-number">4.4.3.</span> <span class="toc-text"> 链路状态路由算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ospf的区域"><span class="toc-number">4.4.4.</span> <span class="toc-text"> OSPF的区域</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#bgp协议"><span class="toc-number">4.5.</span> <span class="toc-text"> BGP协议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#交换过程"><span class="toc-number">4.5.1.</span> <span class="toc-text"> 交换过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#特点-2"><span class="toc-number">4.5.2.</span> <span class="toc-text"> 特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bgp-4四种报文"><span class="toc-number">4.5.3.</span> <span class="toc-text"> BGP-4四种报文</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#rip-ospf-和-bgp"><span class="toc-number">4.6.</span> <span class="toc-text"> RIP、OSPF 和 BGP</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ip数据报"><span class="toc-number">5.</span> <span class="toc-text"> IP数据报</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#格式"><span class="toc-number">5.1.</span> <span class="toc-text"> 格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#分片"><span class="toc-number">5.2.</span> <span class="toc-text"> 分片</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ipv4-地址"><span class="toc-number">6.</span> <span class="toc-text"> IPv4 地址</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#分类的-ip-地址"><span class="toc-number">6.1.</span> <span class="toc-text"> 分类的 IP 地址</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#网络地址转换-nat"><span class="toc-number">6.1.1.</span> <span class="toc-text"> 网络地址转换 NAT</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#子网划分"><span class="toc-number">6.2.</span> <span class="toc-text"> 子网划分</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#子网掩码"><span class="toc-number">6.2.1.</span> <span class="toc-text"> 子网掩码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#变长子网"><span class="toc-number">6.2.2.</span> <span class="toc-text"> 变长子网</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#无分类编址-cidr"><span class="toc-number">6.3.</span> <span class="toc-text"> 无分类编址 CIDR</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#记法"><span class="toc-number">6.3.1.</span> <span class="toc-text"> 记法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#路由聚合"><span class="toc-number">6.3.2.</span> <span class="toc-text"> 路由聚合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最长前缀匹配"><span class="toc-number">6.3.3.</span> <span class="toc-text"> 最长前缀匹配</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ipv4-路由转发"><span class="toc-number">6.4.</span> <span class="toc-text"> IPv4 路由转发</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#arp-协议"><span class="toc-number">7.</span> <span class="toc-text"> ARP 协议</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#dhcp-协议"><span class="toc-number">8.</span> <span class="toc-text"> DHCP 协议</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#icmp-协议"><span class="toc-number">9.</span> <span class="toc-text"> ICMP 协议</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-差错报文"><span class="toc-number">9.1.</span> <span class="toc-text"> ICMP 差错报文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-询问报文"><span class="toc-number">9.2.</span> <span class="toc-text"> ICMP 询问报文</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#icmp-应用"><span class="toc-number">9.3.</span> <span class="toc-text"> ICMP 应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ipv6"><span class="toc-number">10.</span> <span class="toc-text"> IPv6</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ipv6-数据报格式"><span class="toc-number">10.1.</span> <span class="toc-text"> IPv6 数据报格式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ipv6-vs-ipv4"><span class="toc-number">10.2.</span> <span class="toc-text"> IPv6 vs IPv4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#表示形式"><span class="toc-number">10.3.</span> <span class="toc-text"> 表示形式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#基本地址类型"><span class="toc-number">10.4.</span> <span class="toc-text"> 基本地址类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#过度策略"><span class="toc-number">10.5.</span> <span class="toc-text"> 过度策略</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ip-组播"><span class="toc-number">11.</span> <span class="toc-text"> IP 组播</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ip-组播地址"><span class="toc-number">11.1.</span> <span class="toc-text"> IP 组播地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#igmp-协议"><span class="toc-number">11.2.</span> <span class="toc-text"> IGMP 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#组播路由选择协议"><span class="toc-number">11.3.</span> <span class="toc-text"> 组播路由选择协议</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#移动-ip"><span class="toc-number">12.</span> <span class="toc-text"> 移动 IP</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#路由器"><span class="toc-number">13.</span> <span class="toc-text"> 路由器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#拥塞控制"><span class="toc-number">14.</span> <span class="toc-text"> 拥塞控制</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://uploadbeta.com/api/pictures/random/?key=BingEverydayWallpaperPicture)"><div id="post-info"><div id="post-title"><div class="posttitle">网络层</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-07-01<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2021-07-22</time><span class="post-meta__separator mobile_hidden">|</span><span class="mobile_hidden"><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/计算机网络/">计算机网络</a></span><div class="post-meta-wordcount"><i class="fa fa-eye post-meta__icon" aria-hidden="true">       </i><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><p>主要任务：把 <strong>分组</strong> 从源端传到目的端，为分组交换网上的不同主机提供通信服务。</p>
<p>网络层传输单位是 <strong>数据报</strong></p>
<ul>
<li><strong>路由选择与分组转发</strong></li>
<li><strong>异构网络互联</strong></li>
<li><strong>拥塞控制</strong>
<ul>
<li>所有节点都来不及接受分组，而要丢弃大量分组</li>
<li>开环控制（静态）、闭环控制（动态）</li>
</ul>
</li>
</ul>
<h1 id="传输单元"><a class="markdownIt-Anchor" href="#传输单元"></a> 传输单元</h1>
<table>
<thead>
<tr>
<th>层</th>
<th>传输单元</th>
</tr>
</thead>
<tbody>
<tr>
<td>应用层</td>
<td>报文</td>
</tr>
<tr>
<td>传输层</td>
<td>报文段</td>
</tr>
<tr>
<td>网络层</td>
<td>IP 数据报，<strong>分组</strong></td>
</tr>
<tr>
<td>数据链路层</td>
<td>帧</td>
</tr>
<tr>
<td>物理层</td>
<td>比特流</td>
</tr>
</tbody>
</table>
<h1 id="交换方式"><a class="markdownIt-Anchor" href="#交换方式"></a> 交换方式</h1>
<p>电路交换、报文交换、分组交换（数据报/虚电路）</p>
<h2 id="电路交换"><a class="markdownIt-Anchor" href="#电路交换"></a> 电路交换</h2>
<ul>
<li>建立连接（呼叫/电路建立）→ 通信 → 释放连接（拆除电路）</li>
<li>特点：<strong>独占资源</strong>
<ul>
<li>通信时延小、有序传输、没有冲突、实时性强</li>
<li>建立连接时间长，线路独占效率低，灵活性差，无差错控制能力</li>
</ul>
</li>
</ul>
<h2 id="报文交换"><a class="markdownIt-Anchor" href="#报文交换"></a> 报文交换</h2>
<p>报文：源应用发送的信息整体</p>
<ul>
<li>优缺点：
<ul>
<li>无需建立连接，存储转发，动态分配线路，线路可靠性高、利用率高，多目标服务</li>
<li>有存储转发时延，报文大小不定，需要网络节点有较大的缓存空间</li>
</ul>
</li>
</ul>
<h2 id="分组交换"><a class="markdownIt-Anchor" href="#分组交换"></a> 分组交换</h2>
<p>分组：对报文交换的改进，把报文分割成小的数据块</p>
<ul>
<li>优缺点：
<ul>
<li>无需建立连接；存储转发，动态分配线路；线路可靠性高、利用率高；存储管理更容易</li>
<li>存储转发时延；需要传输额外的信息量；乱序到目的主机的话，要对分组排序重组</li>
</ul>
</li>
</ul>
<h1 id="数据报和虚电路"><a class="markdownIt-Anchor" href="#数据报和虚电路"></a> 数据报和虚电路</h1>
<p><em>数据报方式</em> 为 <strong>无连接服务</strong>。<em>虚电路方式</em> 为 <strong>连接服务</strong>。</p>
<ul>
<li><strong>无连接服务</strong>：不事先为分组的传输确认路径，每个分组 <strong>独立确认传输路径</strong>，不同分组传输路径可能不同</li>
<li><strong>连接服务</strong>：首先为分组的传输确定传输路径（建立连接），然后沿该路径（连接）传输系列分组，系列分组传输路径相同，传输结束后拆除连接</li>
</ul>
<h2 id="数据报"><a class="markdownIt-Anchor" href="#数据报"></a> 数据报</h2>
<p><strong>每个分组携带源和目的地址</strong></p>
<p><strong>路由器根据分组的目的地址转发分组</strong>：基于路由协议/算法构建转发表；检索转发表；每个分组独立选路</p>
<ul>
<li>转发表：目的网络地址 + 链路接口</li>
</ul>
<h2 id="虚电路"><a class="markdownIt-Anchor" href="#虚电路"></a> 虚电路</h2>
<p>虚电路将<strong>数据报方式和电路交换方式结合</strong>，以发挥两者优点。</p>
<p><strong>虚电路</strong>：一条源主机到目的主机类似于电路的路径（<strong>逻辑连接</strong>），路径上所有结点都要维持这条虚电路的建立，都维持一张 <strong>虚电路表</strong>，每一项记录了一个打开的虚电路信息</p>
<p>通信过程：建立连接（虚电路）→数据传输（全双工）→释放连接</p>
<ul>
<li>每个分组携带 <strong>虚电路号</strong>，而非目的地址</li>
<li>源主机发送 <strong>“呼叫请求”分组</strong> 并收到 <strong>“呼叫应答”分组</strong> 后才算建立连接
<ul>
<li>建立连接时候使用方式其实是数据报方式，使用目的地址</li>
</ul>
</li>
<li>源主机发送 <strong>“释放请求”分组</strong> 以拆除虚电路</li>
</ul>
<h2 id="对比"><a class="markdownIt-Anchor" href="#对比"></a> 对比</h2>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200411155835.png" class="lazyload"></p>
<h1 id="路由"><a class="markdownIt-Anchor" href="#路由"></a> 路由</h1>
<h2 id="路由算法"><a class="markdownIt-Anchor" href="#路由算法"></a> 路由算法</h2>
<p>最佳路由：“最佳”只能是相对于某一特定要求下得出的较为合理的选择而已</p>
<h3 id="分类"><a class="markdownIt-Anchor" href="#分类"></a> 分类</h3>
<ul>
<li><strong>静态路由算法（非自适应路由算法）</strong>
<ul>
<li>管理员手工配置路由信息，事先设计好了</li>
<li>简便、可靠，在负荷稳定、拓扑结构变化不大的网络中运行效果很好，广泛用于高度安全的军事网络和较小的商业网络</li>
<li>路由更新慢，不适用大型网络</li>
</ul>
</li>
<li><strong>动态路由算法（自适应路由算法）</strong>
<ul>
<li>路由器之间彼此交换信息，按照路由算法优化出路由表项</li>
<li>路由更新快，使用大型网络，及时响应链路费用或网络拓扑变化</li>
<li>算法复杂，增加网络负担</li>
</ul>
</li>
</ul>
<p>其中动态路由算法还分为</p>
<ul>
<li><strong>全局性：链路状态路由算法 OSPF</strong>
<ul>
<li>所有的路由器掌握完整的网络拓扑和链路费用信息</li>
</ul>
</li>
<li><strong>分散性：距离向量路由算法 RIP</strong>
<ul>
<li>路由器只掌握物理相邻的邻居及链路费用</li>
</ul>
</li>
</ul>
<h2 id="分层次的路由选择协议"><a class="markdownIt-Anchor" href="#分层次的路由选择协议"></a> 分层次的路由选择协议</h2>
<ol>
<li>因特网规模很大，分层次能更好地管理</li>
<li>许多单位不想让外界知道自己的路由选择协议，但还想连入因特网</li>
</ol>
<ul>
<li><strong>自治系统AS</strong>：在单一的技术管理下的一组路由器，而这些路由器使用一种AS内部的路由选择协议和共同的度量以 <strong>确定分组在该AS内的路由</strong>，同时还使用一种AS之间的路由选择协议以 <strong>确定AS之间的路由</strong>
<ul>
<li>一个AS内的所有网络都属一个行政单位来管辖，一个自治系统的所有路由器在本自治系统内都必须连通</li>
</ul>
</li>
</ul>
<p>因此路由选择协议分成了</p>
<ul>
<li><strong>内部网关协议 IGP</strong>：一个 AS 内使用的，RIP、OSPF</li>
<li><strong>外部网关协议 EGP</strong>：AS 之间使用的，BGP</li>
</ul>
<h2 id="rip-协议和距离向量算法"><a class="markdownIt-Anchor" href="#rip-协议和距离向量算法"></a> RIP 协议和距离向量算法</h2>
<p>RIP (Routing Information Protocol) 是一种分布式的基于 <strong>距离向量</strong> 的路由选择协议，是因特网的协议标准，最大优点是 <strong>简单</strong><br>
RIP 协议要求网路中的每一个路由器都维护 <strong>从它自己到其他每一个目的网络的唯一最佳距离（即一组距离）</strong></p>
<ul>
<li>距离：通常为“跳数”，即从源端口到目的端口所经过的路由器个数。
<ul>
<li>从一路由器到直接连接的网络距离为 1</li>
<li>RIP 允许一条路由最多只能包含 15 个路由器，<strong>距离为 16 表示网络不可达</strong></li>
</ul>
</li>
<li>RIP 协议只适用于 <strong>小互联网</strong></li>
</ul>
<h3 id="rip特点"><a class="markdownIt-Anchor" href="#rip特点"></a> RIP特点</h3>
<ol>
<li>仅和 <strong>相邻路由器</strong> 交换信息</li>
<li>路由器交换的信息是 <strong>路由表</strong></li>
<li>每30秒交换一次路由信息，然后路由器根据新信息更新路由表。若超过180s没收到邻居路由器的通告，则判断邻居没了，并更新自己的路由表</li>
</ol>
<ul>
<li>
<p>无穷计算问题：设置一个上限，超过表示不可达</p>
</li>
<li>
<p>好消息传得快，坏消息传得慢，导致 <strong>“慢收敛”</strong></p>
</li>
</ul>
<h3 id="路由表的建立"><a class="markdownIt-Anchor" href="#路由表的建立"></a> 路由表的建立</h3>
<ul>
<li>路由器刚开始工作时，只知道直接连接的网络的距离（距离为1），接着每一个路由器也只和数目非常有限的相邻路由器交换并更新路由信息</li>
<li>经过若干次更新后，所有路由器最终都会知道到达本自治系统任何一个网络的 <strong>最短距离和下一跳路由器</strong> 的地址，即 <strong>“收敛”</strong>
<ul>
<li>“收敛”是指，在自治系统中，所有的结点都得到正确的路由选择信息时的状态</li>
</ul>
</li>
</ul>
<h3 id="rip报文"><a class="markdownIt-Anchor" href="#rip报文"></a> RIP报文</h3>
<p>一个 RIP 报文最多可包括 25 个路由，如超过，必须在用一个 RIP 报文传送，使用 <strong>UDP</strong> 传送数据，因此可以说 RIP 协议是应用层协议<br>
<img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200415194838.png" class="lazyload"></p>
<h3 id="距离向量算法"><a class="markdownIt-Anchor" href="#距离向量算法"></a> 距离向量算法</h3>
<ol>
<li>
<p>修改相邻路由器发来的 RIP 报文中所有表项</p>
<p>对地址为 X 的相邻路由器发来的 RIP 报文，修改此报中的所有项目：<strong>把“下一跳”字段中的地址改为 X，并把所有的“距离”字段 + 1</strong></p>
</li>
<li>
<p>对修改后的 RIP 报文中的每一个项目，进行一下步骤：</p>
<p>(1) 若路由表中没有该项目，则添加</p>
<p>(2) 若已有该项目，则查看下一跳路由器的地址：</p>
<ul>
<li>若下一跳就是 X，则用收到的项目替换源路由表中的项目</li>
<li>若下一跳不是 X，若原距离比项目中的距离大则更新，否则不做处理</li>
</ul>
</li>
<li>
<p>若 180s 还没收到相邻路由器 X 的更新路由表，则把 X 记为不可达路由器，即把距离设为 16</p>
</li>
<li>
<p>返回 1</p>
</li>
</ol>
<h2 id="ospf-协议与链路状态算法"><a class="markdownIt-Anchor" href="#ospf-协议与链路状态算法"></a> OSPF 协议与链路状态算法</h2>
<p>开放最短路径优先 OSPF (Open Shortest Path First) 协议：“开放”标明 OSPF 协议不是受某一家厂商控制，而是公开发表的；“最短路径优先”是因为使用了 <strong>Dijkstra</strong> 提出的 <strong>最短路径算法SPF</strong></p>
<p>OSPF 最主要的特征就是使用了分布式的 <strong>链路状态协议</strong></p>
<h3 id="特点"><a class="markdownIt-Anchor" href="#特点"></a> 特点</h3>
<ol>
<li>使用扩散法向自治系统内 <strong>所有路由器</strong> 发送信息，即路由器通过输出端口向所有邻居的路由器发送信息，而每个相邻路由器又再次将此信息发往其所有的相邻路由器</li>
<li>发送的信息就是本路由器 <strong>相邻的所有路由器的链路状态</strong>（本路由器和哪些路由器相邻，以及该链路的度量/代价——费用、距离、时延、带宽等）</li>
<li>只有当 <strong>链路状态发生变化时</strong>，路由器才向所有路由器扩展发送此信息</li>
<li>所有路由器都能建立一个 <strong>链路状态数据库</strong>，即 <strong>全网拓扑图</strong></li>
</ol>
<ul>
<li>每隔30min，刷新一次数据库中的链路状态</li>
<li>由于一个路由器的链路状态只涉及到与相邻路由器的连通状态，因而与互联网的规模并无直接关系。因此当互联网规模很大时，OSPF 要比 RIP 好多了</li>
<li>OSPF 不存在坏消息传得慢，它的 <strong>收敛速度很多</strong></li>
<li>支持可变长度的子网划分和无分类编址 CIDR</li>
</ul>
<h3 id="ospf报文"><a class="markdownIt-Anchor" href="#ospf报文"></a> OSPF报文</h3>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200415200101.png" class="lazyload"></p>
<h3 id="链路状态路由算法"><a class="markdownIt-Anchor" href="#链路状态路由算法"></a> 链路状态路由算法</h3>
<ol>
<li>每个路由器发现它的邻居结点【HELLO问候分组】，并了解邻居结点的网络地址</li>
<li>设置到它的每个邻居的成本度量metric</li>
<li>构造【DD数据库描述分组】，向邻站给出自己的链路状态数据库中的所有链路状态项目的摘要信息</li>
<li>如果DD分组中的摘要自己都有，邻站不做处理；如果有没有的或者是更新的，则发送【LSR链路状态请求分组】请求自己没有的和更新的信息</li>
<li>收到邻站的LSR分组后，发送【LSU链路状态更新分组】进行更新</li>
<li>更新完毕后，邻站返回一个【LSAck链路状态确认分组】进行更新</li>
</ol>
<ul>
<li>只要有一个路由器的链路状态发生变化：</li>
</ul>
<ol start="5">
<li>泛洪发送【LSU链路状态更新分组】进行更新</li>
<li>更新完毕后，其他站返回一个【LSAck链路状态确认分组】进行更新</li>
<li>使用 Dijkstra 算法根据自己的链路状态数据库构造到其他节点间的最短路径</li>
</ol>
<h3 id="ospf的区域"><a class="markdownIt-Anchor" href="#ospf的区域"></a> OSPF的区域</h3>
<p>为了使 OSPF 能够用于规模很大的网络，OSPF 将一个自治系统再划分为若干个更小的范围，叫做区域。</p>
<p>每个区域都有一个32位的区域标识符（用点分十进制表示）。</p>
<p>区域不能太大，在一个区域内的路由器最好不超过 200 个</p>
<ul>
<li>区域内部路由器，区域边界路由器，主干路由器，自治系统边界路由器</li>
</ul>
<h2 id="bgp协议"><a class="markdownIt-Anchor" href="#bgp协议"></a> BGP协议</h2>
<p>与其他AS的邻站<strong>BGP发言人</strong>交换信息</p>
<p>交换的网络可达性的信息，即要到达某个网络说要经过的一系列AS</p>
<p>发生变化时更新有变化部分</p>
<h3 id="交换过程"><a class="markdownIt-Anchor" href="#交换过程"></a> 交换过程</h3>
<p>BGP 所交换的网络可达性的信息就是要 <strong>到达某个网络说要经过的一系列AS</strong>。当 BGP 发言人互相交换了网络可达性信息后，各 BGP 发言人就根据所采用的策略从收到的路由信息中找出到达各 AS 的 <strong>较好路由</strong></p>
<ul>
<li>因特网的规模太大，使得自治系统之间路由选择非常困难</li>
<li>BGP 只能是 <strong>力求寻找一条能够到达目的网络且比较好的路由</strong>，而并非要寻找一条最佳路由</li>
</ul>
<p>BGP 协议采用 <strong>路径向量</strong> 算法，<strong>BGP 发言人交换路径向量</strong></p>
<ul>
<li>路径向量算法尽管与距离向量算法类似，但有两点不同
<ul>
<li><strong>舍弃了路由度量值</strong>，不包含距离或耗费的估计值</li>
<li>每个路由信息块列出沿某路由到达目标网络要经过的所有AS</li>
</ul>
</li>
<li><strong>路由通告消息中携带完整的路径</strong>，易于让接收路由器发现和打破路由循环</li>
</ul>
<h3 id="特点-2"><a class="markdownIt-Anchor" href="#特点-2"></a> 特点</h3>
<ul>
<li>BGP 支持 <strong>CIDR</strong>，因此 BGP 的路由表应当包括目的网络前缀、下一跳路由器，以及到达该目的网络所要经过的各个自治系统序列</li>
<li>在 BGP 刚刚运行时，BGP 的邻站是交换整个的 BGP 路由表，但 <strong>以后只需要在发生变化时更新有变化的部分</strong>，这样做有利于节省网络带宽和减少路由器的处理开销</li>
</ul>
<h3 id="bgp-4四种报文"><a class="markdownIt-Anchor" href="#bgp-4四种报文"></a> BGP-4四种报文</h3>
<ol>
<li><strong>OPEN（打开）报文</strong>：用来与相邻的另一个BGP发言人建立关系，并认证发送方</li>
<li><strong>UPDATE（更新）报文</strong>：通告新路径或撤销原路径</li>
<li><strong>KEEPALIVE（保活）报文</strong>：在无UPDATE时，周期性证实邻站的连通性；也作为OPEN的确认</li>
<li><strong>NOTIFICATION（通知）报文</strong>；报告向前报文的差错；也被用于关闭连接</li>
</ol>
<h2 id="rip-ospf-和-bgp"><a class="markdownIt-Anchor" href="#rip-ospf-和-bgp"></a> RIP、OSPF 和 BGP</h2>
<p><strong>RIP</strong> 是一种分布式的基于 <strong>距离向量</strong> 的 <strong>内部网关路由选择协议</strong>，通过广播 <strong>UDP</strong> 报文来交换路由信息</p>
<p><strong>OSPF</strong> 是一个基于 <strong>链路路由状态</strong> 的 <strong>内部网关协议</strong>，要交换的信息较大，应使报文长度尽量短，所以不使用传输层协议（如UDP、TCP），而是直接采用 <strong>IP</strong></p>
<p><strong>BGP</strong> 是一个基于 <strong>路径向量</strong> 的 <strong>外部网关协议</strong>，在不同的 AS 之间交换路由信息，由于网络复杂，需要保证可靠传输，所以采用了 <strong>TCP</strong></p>
<ul>
<li>力求寻找一条能够到达目的网络且比较好的路由，不需要最佳</li>
</ul>
<h1 id="ip数据报"><a class="markdownIt-Anchor" href="#ip数据报"></a> IP数据报</h1>
<h2 id="格式"><a class="markdownIt-Anchor" href="#格式"></a> 格式</h2>
<ul>
<li>一个 IP 分组由 <strong>首部和数据</strong> 两部分组成</li>
<li>首部的前一部分是 <strong>固定长度</strong>，共 <strong>20B</strong>，是所有 IP 分组必须具有的</li>
<li>在首部固定部分之后的是一 些 <strong>可选字段</strong>，其 <strong>长度可变</strong></li>
</ul>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200411163121.png" class="lazyload"></p>
<ul>
<li>版本号 (Version) 占4位：指出创建分组的 IP 版本</li>
<li>首部长度 (Header Length) 占4位
<ul>
<li>指出分组头(Packet Header)的长度</li>
<li>以 <strong>4个字节为单位</strong> 表示长度</li>
</ul>
</li>
<li>服务类型 (Type of Service) 占 8 位：指示期望获得哪种类型的服务</li>
<li>分组长度 (Packet Length)：指示整个 IP 分组的长度，<strong>单位是字节</strong>
<ul>
<li>一个 16 比特的字段</li>
<li>IP 数据包最长可达 65535 个字节，但是不会达到，受到链路层 MTU 的限制</li>
</ul>
</li>
<li>标识、标志、段偏移：数据包的分段和重组相关</li>
<li>生存时间 (TTL)：IP 分组的保质期
<ul>
<li>经过一个路由器 -1，变成 0 则丢弃</li>
<li>每一个新产生的 IP 数据包，TTL 都被设置为最大生存周期 255</li>
</ul>
</li>
<li>协议占 8 位：指出此 IP 分组携带的数据使用何种协议</li>
<li>首部校验和：只校验首部
<ul>
<li>TTL 不断变化，不采用 CRC 校验码</li>
</ul>
</li>
</ul>
<p><strong>一种八片的首饰：1 总（长度）；8 片（长度）；首（部长度） 4</strong></p>
<h2 id="分片"><a class="markdownIt-Anchor" href="#分片"></a> 分片</h2>
<p>IP 数据报长度超过链路层的 MTU (Maximum Transmission Unit, 最大传输单元)</p>
<ul>
<li>以太网的 MTU 为 1500B</li>
<li>IP 数据报中数据的最长长度为 MTU - 首部 (20B+)</li>
</ul>
<p>标识、标志、段偏移：数据包的分段和重组相关</p>
<ul>
<li><strong>标识</strong>：同一数据报的分片使用同一标识
<ul>
<li>16 位，保证上一个使用该标识符的所有分段已经消失</li>
</ul>
</li>
<li><strong>标志</strong>：3 位，只有低 2 位有意义
<ul>
<li><strong>中间位 DF(Don’t Fragment)</strong>：为 1 禁止分片；为 0 允许分片</li>
<li><strong>最低位 MF(More Fragment)</strong>：为 1 表示后面还有分片；为 0 表示为最后一片</li>
</ul>
</li>
<li><strong>片偏移</strong>：指出较长分组分片后，某片在原分组中的相对位置
<ul>
<li><strong>以 8B 为单位</strong>，除了最后一个分片，每个分片长度一定是 8B 的整数倍</li>
</ul>
</li>
</ul>
<h1 id="ipv4-地址"><a class="markdownIt-Anchor" href="#ipv4-地址"></a> IPv4 地址</h1>
<h2 id="分类的-ip-地址"><a class="markdownIt-Anchor" href="#分类的-ip-地址"></a> 分类的 IP 地址</h2>
<p>全世界唯一的 <strong>32位</strong> 标识符，标识路由器主机的接口<br>
IP 地址 ::= {&lt;网络号&gt;, &lt;主机号&gt;}</p>
<ul>
<li>一般使用点分十进制，而不是 32 位二进制数，如 255.255.255.255</li>
</ul>
<p>IPv4 地址按前几位类别比特分成 A、B、C、D、E 五类</p>
<ul>
<li>A(0)、B(10)、C(110) 类地址为单播地址，这类地址可以分为网络号和主机号两部分</li>
</ul>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200412105448.png" class="lazyload"></p>
<ul>
<li>D(1110) 类地址为组播地址</li>
<li>E(1111) 类地址保留，以备将来的特殊使用</li>
</ul>
<p><strong>特殊 IP 地址</strong><br>
<img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200412104416.png" class="lazyload"></p>
<p><strong>私有地址</strong></p>
<table>
<thead>
<tr>
<th>地址类别</th>
<th>地址范围</th>
<th>网段个数</th>
</tr>
</thead>
<tbody>
<tr>
<td>A 类</td>
<td>10.0.0.0~10.255.255.255</td>
<td>1</td>
</tr>
<tr>
<td>B 类</td>
<td>172.16.0.0~172.31.255.255</td>
<td>16</td>
</tr>
<tr>
<td>C 类</td>
<td>192.168.0.0~192.168.255.255</td>
<td>256</td>
</tr>
</tbody>
</table>
<ul>
<li>路由器对目的地址是私有 IP 地址的数据报一律不转发</li>
</ul>
<h3 id="网络地址转换-nat"><a class="markdownIt-Anchor" href="#网络地址转换-nat"></a> 网络地址转换 NAT</h3>
<p><strong>NAT(Network Address Translation)</strong>：在 <strong>专用网</strong> 连接到 <strong>因特网</strong> 的路由器上安装 NAT 软件，安装了 NAT 软件的路由器称为 <strong>NAT 路由器</strong>，它至少有一个有效的 <strong>外部全球 IP 地址</strong></p>
<ul>
<li>使用端口号的NAT叫做网络地址与端口号转换 <strong>NAPT</strong></li>
</ul>
<h2 id="子网划分"><a class="markdownIt-Anchor" href="#子网划分"></a> 子网划分</h2>
<p>分类的 IP 地址：空间利用率低；两级 IP 地址不够灵活。</p>
<p>从两级 IPv4 地址到三级 IPv4 地址：增加了 <strong>“子网号字段”</strong></p>
<ul>
<li>划分子网纯属是一个单位内部的事情，对外仍<strong>表现为没有划分子网的网络</strong></li>
</ul>
<h3 id="子网掩码"><a class="markdownIt-Anchor" href="#子网掩码"></a> 子网掩码</h3>
<p>使用 <strong>子网掩码(subnet mask)</strong> 可以找出 IP 地址中的子网部分<br>
子网掩码特点：</p>
<ul>
<li>长度为 32 位的比特串</li>
<li>左边部分有一连串的比特 1，对应于网络号和子网号</li>
<li>右边部分有一连串的比特 0，对于主机号</li>
</ul>
<p>子网掩码的作用：使用子网掩码与同一子网的IP地址进行 <strong>相“与”</strong> 运算（二进制逻辑与），可以 <strong>得到该地址的子网号</strong></p>
<ul>
<li><strong>(IP 地址) AND (子网掩码) = 网络地址</strong></li>
</ul>
<p>子网掩码能否全 1 或全 0？</p>
<ul>
<li>正常不能全为 1 或 0</li>
<li>使用 CIDR 的话，可以全 1 或 0</li>
</ul>
<h3 id="变长子网"><a class="markdownIt-Anchor" href="#变长子网"></a> 变长子网</h3>
<p>子网划分有：固定长度子网和变长子网</p>
<ul>
<li>在采用固定长度子网时，所划分的所有子网的子网掩码都是相同的</li>
<li>变长子网采用 VLSM（Variable Length Subnet Mask, 可变长子网掩码）
<ul>
<li>一种产生不同大小子网的网络分配机制</li>
</ul>
</li>
</ul>
<h2 id="无分类编址-cidr"><a class="markdownIt-Anchor" href="#无分类编址-cidr"></a> 无分类编址 CIDR</h2>
<p>以可变长分块的方式分配剩下的 C 类网络<br>
特点：</p>
<ol>
<li>消除了传统的A类、B类和C类地址以及划分子网的概念</li>
<li>融合了子网地址与子网掩码，方便子网划分</li>
</ol>
<h3 id="记法"><a class="markdownIt-Anchor" href="#记法"></a> 记法</h3>
<p>CIDR 采用“斜线记法(slash notation)”，又称 CIDR 记法：IP 地址后面加上“/”，然后写上网络前缀所占的位数</p>
<ul>
<li>对应三级编址中子网掩码中 1 的个数</li>
</ul>
<h3 id="路由聚合"><a class="markdownIt-Anchor" href="#路由聚合"></a> 路由聚合</h3>
<p>CIDR 把 <strong>网络前缀都相同</strong> 的连续的 IP 地址组成一个“CIDR地址块”，这个合并过程叫做 <strong>地址聚合或路由聚合</strong></p>
<ul>
<li>产生的超大前缀地址块称为 <strong>超网</strong>，前缀位数是减少的，但是范围增大了</li>
<li>路由聚合目的：<strong>缩小路由表的表项</strong></li>
</ul>
<h3 id="最长前缀匹配"><a class="markdownIt-Anchor" href="#最长前缀匹配"></a> 最长前缀匹配</h3>
<p>使用 CIDR 时，查找路由表可能得到几个匹配结果，应选择具有 <strong>最长网络前缀</strong> 的路由。</p>
<ul>
<li>前缀越长，地址块越小，路由越具体</li>
</ul>
<h2 id="ipv4-路由转发"><a class="markdownIt-Anchor" href="#ipv4-路由转发"></a> IPv4 路由转发</h2>
<p>在划分子网情况下，路由器转发分组的流程：</p>
<ol>
<li>提取目的 IP 地址</li>
<li>是否直接交付</li>
<li>特定主机路由</li>
<li>检测路由表中是否有路径</li>
<li>默认路由 0.0.0.0</li>
<li>丢弃，报告转发分组出错</li>
</ol>
<p><img alt="image-20200617163924608" data-src="assets/image-20200617163924608.png" class="lazyload"></p>
<h1 id="arp-协议"><a class="markdownIt-Anchor" href="#arp-协议"></a> ARP 协议</h1>
<p>ARP (Address Resolution Protocol)：地址解析协议</p>
<p>ARP 高速缓存：IP 地址与 MAC 地址的映射（IP-&gt;MAC），存储的都是同一局域网中的主机</p>
<ul>
<li>同一局域网
<ul>
<li>广播 ARP 请求分组：IP1 + IP2 + MAC1 + 全1（广播）</li>
<li>单播 ARP 响应分组：IP2 + MAC2</li>
</ul>
</li>
<li>不同局域网
<ul>
<li>广播 ARP 请求分组：IP1 + IP2（默认网关） + MAC1 + 全1（广播）</li>
</ul>
</li>
</ul>
<p>由于在实际网络的链路上传送数据帧时，最终必须使用MAC地址。</p>
<p>ARP 协议：完成主机或路由器 IP 地址到 MAC 地址的映射，<strong>解决下一跳走哪的问题</strong></p>
<p>ARP 协议使用过程：</p>
<ul>
<li>检查 <strong>ARP 高速缓存</strong>，有对应表项则写入 MAC 帧，没有则用目的 MAC 地址为 FF-FF-FF-FF-FF-FF 的帧封装并<strong>广播 ARP 请求分组</strong>，<strong>同一局域网中</strong>所有的主机都能收到该请求。目的主机收到请求后就会向源地址<strong>单播一个 ARP 响应分组</strong>，源主机收到后将此映射<strong>写入 ARP 缓存</strong>（定期更新）</li>
</ul>
<p>ARP 协议 4 种典型情况</p>
<ul>
<li>主机 A 发给 <strong>本网络</strong> 上的主机 B：用 ARP 找到主机 B 的 MAC</li>
<li>主机 A 发给 <strong>另一网络</strong> 的主机 B：用 ARP 找到本网络上一个路由器（网关）的 MAC</li>
<li>路由器发给 <strong>本网络</strong> 的主机 A：用 ARP 找到主机 A 的 MAC</li>
<li>路由器发给 <strong>另一网络</strong> 的主机 B：用 ARP 找到本网络一个路由器的 MAC</li>
</ul>
<h1 id="dhcp-协议"><a class="markdownIt-Anchor" href="#dhcp-协议"></a> DHCP 协议</h1>
<p><strong>DHCP(Dynamic Host Configuration Protocol)</strong>：<strong>动态主机配置协议</strong>，是 <strong>应用层</strong> 协议，使用 <strong>客户/服务器</strong> 方式，客户端和服务器通过 <strong>广播</strong> 方式进行交互，基于 <strong>UDP</strong></p>
<p>DHCP 提供 <strong>即插即用</strong> 联网的机制，主机可以从服务器动态获取 <strong>IP 地址、子网掩码、默认网关、DNS 服务器名称与 IP 地址</strong>，允许 <strong>地址重用</strong>，支持 <strong>移动用户加入网络</strong>，支持 <strong>在用地址续租</strong><br>
工作流程：</p>
<ol>
<li><strong>主机广播 <em>DHCP 发现报文</em></strong>：试图找到网络中的服务器，服务器获得一个 IP 地址</li>
<li><strong>DHCP 服务器广播 <em>DHCP 提供报文</em></strong>：服务器拟分配给主机一个 IP 地址及相关配置，先到先得</li>
<li><strong>主机广播 <em>DHCP 请求报文</em></strong>：主机向服务器请求提供 IP 地址，同时也告知其他服务器：“不用它们的 IP 地址了，可以分配给其他主机了”</li>
<li><strong>DHCP 服务器广播 <em>DHCP 确认报文</em></strong>：正式将 IP 地址分配给主机</li>
</ol>
<ul>
<li>
<p>全是 <strong>广播方式</strong></p>
</li>
<li>
<p>DHCP 使用 C/S 模式，基于 UDP 工作，运行在 67（服务器）、68（客户）端口</p>
</li>
</ul>
<h1 id="icmp-协议"><a class="markdownIt-Anchor" href="#icmp-协议"></a> ICMP 协议</h1>
<p><strong>ICMP(Internet Control Message Protocol)</strong>：<strong>Internet 控制报文协议</strong></p>
<ul>
<li>差错报告、网络探询：发送特定的 ICMP 报文
<ul>
<li>ICMP 报文装载在 IP 数据报的数据部分</li>
</ul>
</li>
</ul>
<h2 id="icmp-差错报文"><a class="markdownIt-Anchor" href="#icmp-差错报文"></a> ICMP 差错报文</h2>
<ol>
<li><strong>终点不可达</strong>：无法交付</li>
<li><strong><s>源点抑制</s></strong>：拥塞丢数据，不常用</li>
<li><strong>时间超过</strong>：TTL=0</li>
<li><strong>参数问题</strong>：首部字段有问题</li>
<li><strong>改变路由（重定向）</strong>：你值得更好的路由</li>
</ol>
<p><strong>不应该发送 ICMP 差错报文的情况</strong>：</p>
<ol>
<li>对 <strong>ICMP 差错报告报文</strong> 不再发送 ICMP 差错报告报文</li>
<li>对第一个分片的数据报片的所有 <strong>后续数据报片</strong> 都不发送 ICMP 差错报告报文</li>
<li>对具有 <strong>组播地址</strong> 的数据报都不发送 ICMP 差错报告报文</li>
<li>对具有 <strong>特殊地址</strong>（如 127.0.0.0）的数据报不发送 ICMP 差错报告报文</li>
</ol>
<h2 id="icmp-询问报文"><a class="markdownIt-Anchor" href="#icmp-询问报文"></a> ICMP 询问报文</h2>
<ol>
<li><strong>回送请求和回答报文</strong>：测试目的站是否可达以及了解其相关状态</li>
<li><strong>时间戳请求和回答报文</strong>：用来进行时钟同步和测量时间</li>
<li><strong><s>掩码地址请求和回答报文</s></strong></li>
<li><strong><s>路由器询问和通告报文</s></strong></li>
</ol>
<h2 id="icmp-应用"><a class="markdownIt-Anchor" href="#icmp-应用"></a> ICMP 应用</h2>
<ul>
<li><strong>PING</strong>；测试两个主机之间的连通性，使用了 <strong>ICMP回送请求和回答报文</strong></li>
<li><strong>Traceroute</strong>：通过设置TTL来跟踪一个分组从源点到终点的路径，使用了 <strong>ICMP时间超过差错报文</strong></li>
</ul>
<h1 id="ipv6"><a class="markdownIt-Anchor" href="#ipv6"></a> IPv6</h1>
<ul>
<li>从根本上解决地址耗尽问题</li>
<li>改进首部格式，快速处理/转发数据报</li>
<li>支持 QoS (Quality of Service)</li>
</ul>
<h2 id="ipv6-数据报格式"><a class="markdownIt-Anchor" href="#ipv6-数据报格式"></a> IPv6 数据报格式</h2>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/easonzzzz/BlogPic/img/20200420101328.png" class="lazyload"></p>
<ul>
<li>首部固定 40 B</li>
<li><strong>版本</strong> 总是 6</li>
<li>区分数据报的类别和 <strong>优先级</strong></li>
<li>同属一个流的数据报具有同样的 <strong>流标签</strong>，类似于标识符</li>
<li><strong>有效负荷长度</strong> 为 <em>扩展首部+数据</em> 的长度</li>
<li><strong>下一个首部</strong> 标识下一个扩展首部或上一层协议首部</li>
<li><strong>跳数限制</strong> 相当于 TTL</li>
</ul>
<h2 id="ipv6-vs-ipv4"><a class="markdownIt-Anchor" href="#ipv6-vs-ipv4"></a> IPv6 vs IPv4</h2>
<ol>
<li>地址扩展从32位（4B）扩大到 <strong>128位（16B）</strong></li>
<li><strong>移除校验和字段</strong>，以减少每跳的处理时间</li>
<li>移除可选字段，变成 <strong>扩展首部</strong>，成为灵活的首部格式</li>
<li>支持 <strong>即插即用</strong>，不需要 DHCP</li>
<li>首部长度必须是 <strong>8B的整数倍</strong>，而 IPv4 是 4B 的整数倍</li>
<li><strong>只能在主机处分片</strong>，IPv4 可以在路由器和主机分片</li>
<li>ICMPv6：附加报文类型“分组过大”</li>
<li>支持资源预分配</li>
<li>取消协议字段，改成下一个首部字段</li>
<li>取消了总长度字段，改用有效载荷长度字段</li>
<li>取消了服务类型字段</li>
</ol>
<h2 id="表示形式"><a class="markdownIt-Anchor" href="#表示形式"></a> 表示形式</h2>
<p><strong>一般形式</strong>：冒号十六进制记法，用32位16进制数表示，4位一组</p>
<p><strong>压缩形式</strong>：删除 0，如果是 0000 就是 0，保证每一个分组都有一位数字</p>
<ul>
<li><strong>零压缩：一连串连续的0可以被一对冒号取代</strong>，但是 <em>仅能使用一次</em></li>
</ul>
<h2 id="基本地址类型"><a class="markdownIt-Anchor" href="#基本地址类型"></a> 基本地址类型</h2>
<ul>
<li><strong>单播</strong>：一对一通信，可做源地址+目的地址</li>
<li><strong>多播</strong>：一对多通信，可做目的地址</li>
<li><strong>任播</strong>：一对多中的一个通信，可做目的地址</li>
</ul>
<h2 id="过度策略"><a class="markdownIt-Anchor" href="#过度策略"></a> 过度策略</h2>
<ol>
<li><strong>双栈协议</strong>：<strong>同时启用</strong> IPv4协议中和IPv6协议栈</li>
<li><strong>隧道技术</strong>：将其他协议的数据帧或包 <strong>重新封装</strong> 然后通过隧道发送</li>
</ol>
<h1 id="ip-组播"><a class="markdownIt-Anchor" href="#ip-组播"></a> IP 组播</h1>
<ul>
<li><strong>单播</strong>：<strong>点对点</strong> 传输</li>
<li><strong>广播</strong>：<strong>点对多点</strong> 传输，是无条件转发</li>
<li><strong>组播（多播）</strong>：当网络中的某些用户需要特定数据时，组播数据发送者仅发送一次数据，借助组播路由协议为组播数据报建立组播分发树，被传递的数据到达距离用户端尽可能近的节点才开始复制和分发，是一种 <strong>点对多点</strong> 的传输方式</li>
</ul>
<h2 id="ip-组播地址"><a class="markdownIt-Anchor" href="#ip-组播地址"></a> IP 组播地址</h2>
<p>IP 组播地址让源地址能够将分组发送给一组设备。属于多播组的设备将被分配 <strong>一个组播组IP地址（一群共同需求主机的相同标识）</strong></p>
<p>组播地址范围为 224.0.0.0~239.255.255.255（D类地址，1110），一个D类地址表示一个组播组。<strong>只能作目的地址，不能作源地址</strong></p>
<ol>
<li>组播数据报也是“尽最大努力交付”，不提供可靠交付，应用于 UDP</li>
<li>对组播数据报不产生 ICMP 差错报文</li>
<li>并非所有的D类地址都能作组播地址</li>
</ol>
<h2 id="igmp-协议"><a class="markdownIt-Anchor" href="#igmp-协议"></a> IGMP 协议</h2>
<p>IGMP (Internet Group Management Protocol) 协议让路由器知道本局域网上 <strong>是否有主机（的进程）参加或退出了某个组播组</strong></p>
<p>主机使用 <strong>IGMP 消息</strong> 通告本地的组播路由器它想接收组播流量的主机组地址。还可以通告组播路由器它退出某主机组。</p>
<p>本地组播路由器周期性探询本局域网的主机，以便知道这些主机是否还是该组播组的成员</p>
<h2 id="组播路由选择协议"><a class="markdownIt-Anchor" href="#组播路由选择协议"></a> 组播路由选择协议</h2>
<p>组播路由选择协议目的是找出以源主机为根节点的 <strong>组播转发树</strong></p>
<h1 id="移动-ip"><a class="markdownIt-Anchor" href="#移动-ip"></a> 移动 IP</h1>
<p>移动 IP 技术是移动节点以固定的网络 IP 地址，实现跨越不同网段的 <strong>漫游</strong> 功能，并保证了基于网络 IP 的网络权限在漫游过程中不发生任何改</p>
<p>基本原理：</p>
<ul>
<li>发现自己在移动–定期监听 ICMP 路由器通告，或发送恳请报文发现最近的路由器。</li>
<li>获得转交 IP 地址–使用 DHCP 服务；或通过外地代理转发。</li>
<li>告知家乡代理当前位置。</li>
<li>家乡代理充当移动主机的 ARP 代理–在本地对移动主机 IP 地址进行应答，并接收给移动主机的数据包。</li>
<li>隧道转发—以转交地址为目的地址的IP包封装数据包。</li>
</ul>
<h1 id="路由器"><a class="markdownIt-Anchor" href="#路由器"></a> 路由器</h1>
<p>路由器是一种具有多个输入端口和多个输入端口的专业计算机，其任务是转发分组。</p>
<ul>
<li><strong>路由选择</strong>：根据所选定的路由选择协议 <strong>构造出路由表</strong>，同时经常或定期地和相邻路由器交换路由信息而不断地 <strong>更新和维护路由表</strong>。
<ul>
<li>路由表项：<strong>目的地址、掩码、网关、标志、接口</strong></li>
</ul>
</li>
<li><strong>交换结构</strong>：根据 <strong>转发表（路由表得来）</strong> 对分组进行转发
<ul>
<li>转发表：由路由表得来，必须包含完成转发功能所必要的信息</li>
</ul>
</li>
</ul>
<h1 id="拥塞控制"><a class="markdownIt-Anchor" href="#拥塞控制"></a> 拥塞控制</h1>
<p><strong>传输层</strong>：重传、乱序缓存、确认、流控、超时中止</p>
<p><strong>网络层</strong>：子网中的虚电路和数据报、分组排队和服务策略、分组丢弃策略、路由算法、分组的生存时间管理</p>
<p>通信量整形（Traffic Shaping）：</p>
<ul>
<li>网络上，突发的通信量是造成拥塞的主要原因。</li>
<li>强迫分组以某种可以预见的速率传送，减少拥塞，这种方法就被称为通信量整形。</li>
<li><strong>漏桶算法</strong> 和 <strong>令牌桶算法</strong> 都可以实现通信量整形。</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">EasonZzZz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/07/01/学习/计网/网络层/">http://yoursite.com/2020/07/01/学习/计网/网络层/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://yoursite.com">Nice To Meet U</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/计网/">计网    </a></div><div class="post_share"></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/07/01/学习/计网/物理层/"><img class="prev_cover lazyload" data-src="https://api.dujin.org/bing/1920.php" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>物理层</span></div></a></div><div class="next-post pull_right"><a href="/2020/07/01/学习/计网/概述/"><img class="next_cover lazyload" data-src="https://api.dujin.org/bing/1920.php" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>概述</span></div></a></div></nav></div></div><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By EasonZzZz</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script async src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar@0.1.15/dist/snackbar.min.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async></script><script src="/js/third-party/click_heart.js"></script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>