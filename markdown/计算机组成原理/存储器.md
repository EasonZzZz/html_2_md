---
title: 存储器
date: 2019-12-26
updated: 2019-12-26
tags:
- 计组
categories:
- 计算机组成原理
---

# 概述
## 分类
按存储介质分类- 半导体存储器：TTL，MOS(易失)
- 磁表面存储器
- 磁芯存储器
- 光盘存储器

按照存取方式- RAM(Random Access Memory)
- ROM(Read Only Memory)
- 串行访问存储器

按在计算机中的作用分类


## 层次结构
存储器三个主要特性的关系

缓存-主存层次和主存-辅存层次


# 主存储器

编址单位：字节
技术指标：- 容量：主存**存放二进制代码的总位数**
- 速度：- 存取时间：存储器的**访问时间**
- 存取周期：连续两次独立的存储器操作所需的**最小间隔时间**，比存取时间长，差个复原时间

- 存取时间：存储器的**访问时间**
- 存取周期：连续两次独立的存储器操作所需的**最小间隔时间**，比存取时间长，差个复原时间
- 带宽：**位/秒(bit/s)**


## 半导体存储芯片
容量：**2地址线×数据线2^{地址线} \times 数据线2地址线×数据线**
译码驱动方式:- 线选法
- 重合法


## RAM
静态RAM(SRAM)
动态RAM(DRAM)- **2ms(刷新周期)**内再生(刷新)，**一行行进行**
- 刷新方式：- 集中刷新(有死区)
- 分散刷新(无死区)
- 异步刷新(两者结合)：刷新安排在指令译码阶段，不会出现死区

- 集中刷新(有死区)
- 分散刷新(无死区)
- 异步刷新(两者结合)：刷新安排在指令译码阶段，不会出现死区


## ROM
掩膜ROM：不能修改
PROM(一次性编程)
EPROM(多次性编程)
EEPROM(电可擦除)
Flash Memory(闪速型存储器)

# 存储器与CPU的连接
存储器容量的扩展- 位扩展(增加存储字长)
- 字扩展(增加存储字的数量)
- 字、位扩展

存储器与CPU的连接- 地址线的连接- 低位接存储芯片，高位作片选信号

- 低位接存储芯片，高位作片选信号
- 数据线的连接
- 读/写命令线的连接
- 片选线的连接
- 合理选择存储芯片
- 其他：时序，负载


做题步骤：- 写出对应二进制地址码
- 确定芯片的数量及类型- 优先位扩展：字扩展要设计片选型号，而位扩展只需将数据线引出即可
- RAM，ROM尽量选择外特性一致，简化连接，避免二级译码

- 优先位扩展：字扩展要设计片选型号，而位扩展只需将数据线引出即可
- RAM，ROM尽量选择外特性一致，简化连接，避免二级译码
- 分配地址线
- 确定片选信号


# 存储器的校验
编码的最小距离：任意两组合法代码之间的二进制位数的**最少差异数**- L - 1 = D + C
- L：最小距离；D：检错位数；C：纠错位数
- **汉明码是具有一位纠错能力的编码**

汉明码的组成三要素- 添加k位校验位：**2^k ≥ n+k+1**[传输n位，分成k组]
- 检测位的位置：**2^i**(i=0,1,……) [这一位不与其他组共用]- C1检测的g1：1，3，5，7，9……C_{1}检测的g_{1}：1，3，5，7，9……C1​检测的g1​：1，3，5，7，9……
- C2检测的g2：2，3，6，7，10……C_{2}检测的g_{2}：2，3，6，7，10……C2​检测的g2​：2，3，6，7，10……
- C4检测的g3：4，5，6，7，12……C_{4}检测的g_{3}：4，5，6，7，12……C4​检测的g3​：4，5，6，7，12……
- C8检测的g4：8，9，10，11，12……C_{8}检测的g_{4}：8，9，10，11，12……C8​检测的g4​：8，9，10，11，12……

- C1检测的g1：1，3，5，7，9……C_{1}检测的g_{1}：1，3，5，7，9……C1​检测的g1​：1，3，5，7，9……
- C2检测的g2：2，3，6，7，10……C_{2}检测的g_{2}：2，3，6，7，10……C2​检测的g2​：2，3，6，7，10……
- C4检测的g3：4，5，6，7，12……C_{4}检测的g_{3}：4，5，6，7，12……C4​检测的g3​：4，5，6，7，12……
- C8检测的g4：8，9，10，11，12……C_{8}检测的g_{4}：8，9，10，11，12……C8​检测的g4​：8，9，10，11，12……
- 检测位的取值：所在小组中承担的**奇偶校验任务**有关

汉明码纠错过程
形成新的检测位P[i]，和该组中1个数有关(奇偶校验决定，一般为偶校验)

# 提高访问速度的措施
采用高速器件
采用层次结构 Cache-主存
调整主存结构- 单体多字：增加存储器的带宽
- 多体并行- 高位交叉：**顺序编址**，各个体**并行工作**(适合存储器扩展，但不适合增加带宽)
- 低位交叉：各个体**轮流编制**，**在不改变存取周期的前提下，增加存储器的带宽**(流水线方式)

- 高位交叉：**顺序编址**，各个体**并行工作**(适合存储器扩展，但不适合增加带宽)
- 低位交叉：各个体**轮流编制**，**在不改变存取周期的前提下，增加存储器的带宽**(流水线方式)
- 高性能存储芯片- SDRAM(同步RAM)
- RDRAM
- 带Cache的DRAM- 集成了一个Cache，有利于猝发式读取

- 集成了一个Cache，有利于猝发式读取

- SDRAM(同步RAM)
- RDRAM
- 带Cache的DRAM- 集成了一个Cache，有利于猝发式读取

- 集成了一个Cache，有利于猝发式读取


# 高速缓冲存储器
## 概述
避免CPU"空等"，**程序访问局部性原理**
### Cache工作原理
主存和缓存的编址
- 主存和缓存**按块存储**，**块大小相等**，B为块长

命中和未命中
缓存有C块，主存有M块，M >> C- 命中：主存块调入缓存，建立了对应关系
- 用**标记**记录与某缓存块建立了对应关系的**主存块号**

Cache命中率：CPU欲访问的信息再Cache中的比率- 与Cache的**容量**和**块长**有关
- 块长取一个存取周期内从主存调出的信息长度

Cache-主存系统的效率- 效率e与命中率有关




### Cache的结构
Cache存储体
地址映射变换机构
替换机构

### Cache的读写操作
读：
写：**Cache和主存的一致性**- 写直达法：既写入Cache又写入主存。**写操作时间就是访问主存的时间**
- 写回法：只把数据写入Cache而不写入主存，但Cache数据被替换出去时才写回主存。**写操作时间就是访问Cache的时间**


### Cache的改进
增加Cache的级数
统一缓存和分立缓存

## Cache-主存的地址映射
### 直接映射
**每个缓存块 i ———— 若干个主存块**
**每个主存块 j ———— 一个缓存块**

把主存划分成若干个**与Cache相等的区**，然后每个区里的字块一一映射到Cache字块
主存地址 = 主存字块标记(区号)[t] + Cache字块地址[c] + 字块内地址[b]
t + c = m

### 全相联映射
**主存中的任一块**可以映射到**缓存中的任一块**

主存地址 = 主存字块标记(m=t+c) + 字块内地址(b)

### 组相联映射
直接映射和全相联映射的结合
Cache被分成**Q组**，每组**R块**
**某一主存块j**按**modQ**映射到缓存的**第i组**中的**任一块**

直接映射：给定的一个块只能放在一个组
全相联映射：给定的一个块可以放到这个组中任一块


## 替换算法
先进先出(FIFO)
近期最少使用(LRU)：较好的利用局部性原理

# 辅助存储器
## 概述
不与CPU直接交换信息
磁表面技术指标：- 记录密度：道密度Dt，位密度Db
- 存储容量：C = n X k X s- C为存储总量，n为盘面数，k为磁道数，s为磁道的二进制代码数

- C为存储总量，n为盘面数，k为磁道数，s为磁道的二进制代码数
- 平均寻址时间：寻道时间+等待时间- 平均等待时间：盘片旋转一周所需的时间的一半(即1转速×2\frac{1}{转速 \times2}转速×21​)

- 平均等待时间：盘片旋转一周所需的时间的一半(即1转速×2\frac{1}{转速 \times2}转速×21​)
- 数据传输率：Dr = Db X V
- 误码率


## 磁记录原理和记录方式
### 磁记录原理
磁层表面被磁化的**极性方式不同**，以区别0和1

### 记录方式
**归零制(RZ)**：RZ记录"1"时，通以正向脉冲；记录"0"时，通以反向脉冲
**不归零(NRZ)**：NRZ记录时，始终有驱动电流，不是正向就是反向。变化才翻转(见变就翻)
**"见1就翻"的不归零制(NEZ1)**：始终有电流，只有见"1"才翻转
**调相制(PM)**：又称相位编码(PE)，记录方式：记录"1"时，写电流由负变正；记录"0"时，写电流由正变负。电流变化出现在中间时刻。连续记录相同信息时，在每两个相同信息的交界处，电流反向；如果相邻信息不同，则电流不变向。
**调频制(FM)**：又称倍频制，以驱动电流变化的频率记录区别0，1。记录"0"时，电流不变；记录"1"时，电流中间时刻反向。交界处均反向一次。所以"0"变化一次，"1"变化两次
**改进型调频制(MFM)**：基本相同FM，但是MFM只有当连续记录两个或两个以上的"0"时，才在每位的起始位改变一次电流，不在每个起始点改变电流。

